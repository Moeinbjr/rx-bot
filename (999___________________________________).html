<!DOCTYPE html>
<!-- saved from url=(0071)file:///C:/Users/moein-bjr/Downloads/RX_BOT-%2D-%2D-%2D-%2D-V(1.3).html -->
<html dir="rtl" lang="fa"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width,initial-scale=1">
<title>RX-BOT — نسخه نهایی (پنل شیشه‌ای)</title>
<style>
  :root{--accent:#00bfff;--card-bg:rgba(255,255,255,0.04)}
  *{box-sizing:border-box}
  body{margin:0;font-family:Tahoma, Arial, sans-serif;background:linear-gradient(135deg,#00bfff,#2b1055);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .card{width:100%;max-width:920px;background:var(--card-bg);padding:18px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
  h1,h2{margin:0 0 8px 0}
  .row{display:flex;gap:12px;align-items:center}
  .col{flex:1}
  input,textarea,button,select{font-family:inherit;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:rgba(255,255,255,0.02);color:#fff;padding:10px;outline:none}
  textarea{min-height:80px;resize:vertical}
  button{cursor:pointer}
  .btn{background:var(--accent);color:#042018;border:none;padding:10px 12px;font-weight:700;border-radius:8px}
  .muted{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 12px;border-radius:8px}
  .hidden{display:none}
  .chat{height:380px;overflow:auto;padding:12px;background:rgba(0,0,0,0.22);border-radius:8px}
  .msg{margin:8px 0;padding:8px 12px;border-radius:12px;max-width:78%}
  .msg.user{margin-left:auto;background:rgba(255,255,255,0.06)}
  .msg.bot{background:rgba(255,255,255,0.02)}
  .meta{font-size:13px;color:rgba(255,255,255,0.8)}
  .panel-btns{display:flex;gap:8px;align-items:center;margin-bottom:8px}
  .panel-btn{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.06);color:#fff;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:600}
  .panel-btn.active{background:var(--accent);color:#021020}
  /* slide-in glass panels */
  .side-panel{position:fixed;top:0;right:-420px;width:400px;height:100vh;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.18));backdrop-filter:blur(12px);border-left:1px solid rgba(0,191,255,0.2);box-shadow:-10px 0 40px rgba(0,191,255,0.12);transition:right .35s cubic-bezier(.2,.9,.2,1),opacity .3s;z-index:9999;padding:20px;overflow:auto;border-radius:16px 0 0 16px;opacity:0}
  .side-panel.open{right:0;opacity:1}
  .side-panel .close{position:absolute;left:14px;top:12px;background:transparent;border:none;color:#fff;font-size:22px;cursor:pointer}
  .panel-content h3{margin-top:6px;margin-bottom:12px}
  .panel-row{display:flex;gap:8px;margin-bottom:8px;align-items:center}
  .panel-field{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
  .panel-note{font-size:13px;opacity:0.85;margin-top:8px}
  @media(max-width:860px){ .row{flex-direction:column} .side-panel{width:100%;right:-100%} .side-panel.open{right:0} }
</style>
<style>/* Copyright (C) Microsoft Corporation. All rights reserved. */

.msreadout-word-highlight:not(.msreadout-inactive-highlight) {
    background: #ffff00 !important;
    color: black !important;
}

.msreadout-line-highlight:not(.msreadout-inactive-highlight) {
    background: #b2d6f3 !important;
    color: black !important;
}

@media screen and (-ms-high-contrast: active) {
    .msreadout-word-highlight:not(.msreadout-inactive-highlight) {
        -ms-high-contrast-adjust: none;
        background-color: Highlight !important;
        color: HighlightText !important;
    }

    .msreadout-line-highlight:not(.msreadout-inactive-highlight) {
        -ms-high-contrast-adjust: none;
        background: yellow !important;
        color: black !important;
    }
}</style></head>
<body>
  <!-- MAIN CARD -->
  <div class="card" id="loginView">
    <h1>RX-BOT</h1>
    <p class="meta">Please enter an email address that you have access to in the username field</p>

    <div class="row" style="margin-top:12px">
      <div class="col">
        <font _mstmutation="1"><label _mstmutation="1">Username<br><input id="username" placeholder="Enter your username" _mstplaceholder="359879"></label>
        <label style="margin-top:8px" _mstmutation="1"><br><input id="password" placeholder="Enter your password" type="password" _mstplaceholder="365677"></label></font>
        <div style="margin-top:10px;display:flex;gap:8px">
          <button class="btn" id="loginBtn">sign in</button>
          <button class="muted" id="demoBtn">sign up</button>
        </div>
        <p class="meta" style="margin-top:8px">If you don't already have an account, create one first and then you can log in with that account</p>
      </div>

      <div class="col" style="min-width:220px">
        <div style="display:flex;justify-content:flex-end;align-items:center;gap:8px">
          <!-- top icons (these will open panels) -->
          <div class="panel-btns" id="panelButtons">
            <button id="userSettingsBtn" class="panel-btn" title="اصلاحات کاربر">🧍‍♂️</button>
            <button id="walletInfoBtn" class="panel-btn" title="اطلاعات کیف پول">💰</button>
          </div>
        </div>

        <div style="margin-top:12px;background:rgba(255,255,255,0.03);padding:10px;border-radius:8px">
          <div class="meta"><strong id="userLabel">newuser@gmail.com</strong></div>
          <div class="meta" style="margin-top:8px">Wallet: $<span id="wallet">10</span></div>
          <div class="meta" style="margin-top:8px">status: <span id="status">نسخهٔ رایگان</span></div>
          <div class="meta" style="margin-top:8px"><font _mstmutation="1">last ently: </font><span id="lastLogin">2025-10-30</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- CHAT VIEW (hidden until login) -->
  <div class="card hidden" id="chatView" style="margin-top:14px">
    <div class="row" style="justify-content:space-between;align-items:flex-start">
      <div style="flex:1;margin-right:12px">
        

        <div class="panel-btns" id="panelButtons2" style="margin-bottom:12px">
          <button id="userSettingsBtn2" class="panel-btn" title="اصلاحات کاربر">🧍‍♂️ user information </button>
          <button id="walletInfoBtn2" class="panel-btn" title="اطلاعات کیف پول">💰 Wallet information</button>
        </div>

        <div aria-label="support chat" aria-live="polite" class="chat" id="chatBox" _mstaria-label="187668"><div class="msg bot">RX-BOT: سلام! من RX-BOT همدرد هستم — خوشحالم که اینجام. بپرس هرچی خواستی.</div></div>

        <div class="row" style="margin-top:10px">
          <textarea id="userInput" placeholder="...Write your message" _mstplaceholder="4937543"></textarea>
        </div>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button class="btn" id="sendBtn">send</button>
          <button class="muted" id="logoutBtn">exit</button>
        </div>
      </div>

      <!-- NOTE: We removed the fixed aside and replaced functionality with slide panels -->
      <div style="min-width:260px"></div>
    </div>
  </div>

  <!-- USER PANEL (slide-in) -->
  <aside id="userSettingsPanel" class="side-panel" aria-hidden="true">
    <button class="close" id="closeUserPanel">×</button>
    <div class="panel-content">
      <h3>User modifications</h3>

      <div class="panel-field">
        <label><font _mstmutation="1">Username</font><br><input id="editUsername" placeholder="Enter your new username" _mstplaceholder="8714654"></label>
      </div>
      <div class="panel-field">
        <label><font _mstmutation="1">password</font><br><input id="editPassword" type="password" placeholder="Enter your new password" _mstplaceholder="6038838"></label>
      </div>

      <div class="panel-row">
        <div class="meta"><strong>The state of pro:</strong> <span id="panelStatus">نسخهٔ رایگان</span></div>
      </div>
      <div class="panel-row">
        <div class="meta"><strong>last entry:</strong> <span id="panelLastLogin">2025-10-30</span></div>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" id="saveUserBtn">Save changes</button>
        <button class="muted" id="logoutPanelBtn">exit</button>
      </div>

      <div class="panel-note">Changing your username will delete your information.Be sure to do so after you've done your work .because your Sheka wallet will also be deleted</div>
    </div>
  </aside>

  <!-- WALLET PANEL (slide-in) -->
  <aside id="walletPanel" class="side-panel" aria-hidden="true">
    <button class="close" id="closeWalletPanel">×</button>
    <div class="panel-content">
      <h3>Wallet information</h3>

      <div class="panel-row">
        <div class="meta">inventory: $<span id="panelWalletAmount">10</span></div>
      </div>

      <div class="panel-row">
        <div class="meta">The state of Pro: <span id="panelWalletStatus">نسخهٔ رایگان</span></div>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" id="panelTopupBtn">💸 charging +10</button>
        <button class="btn" id="panelBuyBtn">⭐ buy pro (10$)</button>
      </div>

      <hr style="opacity:.06;margin:12px 0">
      <div class="panel-note">.Transactions are saved</div>
    </div>
  </aside>

<script>
// ----- Helper / state ----- //
function todayStr(){ const d=new Date(); return d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0')+'-'+String(d.getDate()).padStart(2,'0'); }
let currentUser = '';
let isPro = false;

// elements
const loginView = document.getElementById('loginView');
const chatView = document.getElementById('chatView');
const loginBtn = document.getElementById('loginBtn');
const demoBtn = document.getElementById('demoBtn');
const logoutBtn = document.getElementById('logoutBtn');
const sendBtn = document.getElementById('sendBtn');

const userSettingsBtn = document.getElementById('userSettingsBtn');
const walletInfoBtn = document.getElementById('walletInfoBtn');
const userSettingsBtn2 = document.getElementById('userSettingsBtn2');
const walletInfoBtn2 = document.getElementById('walletInfoBtn2');

const userPanel = document.getElementById('userSettingsPanel');
const walletPanel = document.getElementById('walletPanel');

// login/demo flow
loginBtn.addEventListener('click', ()=>{ const u=document.getElementById('username').value.trim(); if(!u){ alert('لطفاً نام کاربری وارد کنید'); return; } loginUser(u); });
demoBtn.addEventListener('click', ()=> loginUser('demo_user'));

function loginUser(u){
  currentUser = u;
  // initialize wallet & pro flag if missing
  if(localStorage.getItem('wallet_'+currentUser) === null) localStorage.setItem('wallet_'+currentUser, '10');
  if(localStorage.getItem('pro_'+currentUser) === null) localStorage.setItem('pro_'+currentUser, '0');
  // record last login
  const last = localStorage.getItem('_'+currentUser);
  localStorage.setItem('_'+currentUser, todayStr());
  showChatView();
  if(!last) appendBot('سلام '+escapeHtml(currentUser)+'! کیف پول شما با 10$ اولیه تنظیم شد.');
  else appendBot('خوش آمدی '+escapeHtml(currentUser)+' — آخرین ورود: '+last);
}

function showChatView(){
  loginView.classList.add('hidden');
  chatView.classList.remove('hidden');
  updateUI();
  document.getElementById('greetTitle').textContent = 'سلام '+escapeHtml(currentUser)+' — من RX-BOT همدرد هستم';
  document.getElementById('userLabel').textContent = currentUser;
}

// logout
logoutBtn.addEventListener('click', ()=> logout());
document.getElementById('logoutPanelBtn').addEventListener('click', ()=>{ closeAllPanels(); logout(); });

function logout(){
  currentUser = '';
  isPro = false;
  chatView.classList.add('hidden');
  loginView.classList.remove('hidden');
  // reset login fields
  document.getElementById('username').value = '';
  document.getElementById('password').value = '';
  // clear chat
  const box = document.getElementById('chatBox');
  box.innerHTML = '<div class="msg bot">RX-BOT: سلام! من RX-BOT همدرد هستم — خوشحالم که اینجام. بپرس هرچی خواستی.</div>';
}

// UI updates
function updateUI(){
  const w = parseInt(localStorage.getItem('wallet_'+currentUser) || '0',10);
  document.getElementById('wallet').textContent = w;
  isPro = localStorage.getItem('pro_'+currentUser) === '1';
  document.getElementById('status').textContent = isPro ? 'پرو فعال' : 'نسخهٔ رایگان';
  document.getElementById('lastLogin').textContent = localStorage.getItem('_'+currentUser) || '-';
  // panels
  document.getElementById('panelWalletAmount').textContent = w;
  document.getElementById('panelStatus').textContent = isPro ? 'پرو فعال' : 'نسخهٔ رایگان';
  document.getElementById('panelLastLogin').textContent = localStorage.getItem('_'+currentUser) || '-';
  document.getElementById('panelWalletAmount').textContent = w;
  document.getElementById('panelWalletStatus').textContent = isPro ? 'پرو فعال' : 'نسخهٔ رایگان';
  document.getElementById('panelStatus').textContent = isPro ? 'پرو فعال' : 'نسخهٔ رایگان';
  document.getElementById('userLabel').textContent = currentUser || 'کاربر';
  // edit fields default
  document.getElementById('editUsername').value = currentUser || '';
  document.getElementById('editPassword').value = '';
}

// Chat appenders
function appendUser(text){ const box=document.getElementById('chatBox'); const el=document.createElement('div'); el.className='msg user'; el.innerHTML='<div><strong>شما:</strong> '+escapeHtml(text)+'</div>'; box.appendChild(el); box.scrollTop=box.scrollHeight; }
function appendBot(text){ const box=document.getElementById('chatBox'); const el=document.createElement('div'); el.className='msg bot'; el.innerHTML='<div><strong>RX-BOT:</strong> '+escapeHtml(text)+'</div>'; box.appendChild(el); box.scrollTop=box.scrollHeight; }

// basic canned Q&A (kept simple)
const qaPairs = [
  {q: "هوش مصنوعی چیست؟", a: "هوش مصنوعی شاخه‌ای از علوم کامپیوتر است که هدف آن ساخت سیستم‌هایی است که توانایی یادگیری و تصمیم‌گیری شبیه انسان را داشته باشند."},
  {q: "چه کسی تو را ساخته؟", a: "من را معین باغجری ساخته است."},
  {q: "کمک", a: "بگو دقیقاً به چه کمکی نیاز داری تا راهنمایی کنم."}
];

document.getElementById('sendBtn').addEventListener('click', ()=> {
  const t = document.getElementById('userInput').value.trim();
  if(!t) return;
  document.getElementById('userInput').value = '';
  appendUser(t);
  setTimeout(()=> handleBot(t), 250);
});

function handleBot(text){
  const lower = text.toLowerCase();
  for(let i=0;i<qaPairs.length;i++){
    if(lower.includes(qaPairs[i].q.toLowerCase())){ appendBot(qaPairs[i].a); return; }
  }
  if(lower.includes('سلام')||lower.includes('حالت')){ appendBot(isPro ? 'سلام! حالت خوبه — بگو چه کمکی می‌تونم بکنم؟' : 'سلام! برای پاسخ‌های کامل‌تر نسخه پرو را خریداری کن.'); return; }
  if(isPro){ appendBot('پاسخ پرو: '+text); return; }
  appendBot('متشکرم! برای پاسخ بهتر نسخه پرو را تهیه کنید.');
}

// safe HTML escape
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]; }); }

// ----- Panel controls ----- //
function closeAllPanels(){
  [userPanel,walletPanel].forEach(p=>{ p.classList.remove('open'); p.setAttribute('aria-hidden','true'); });
  [userSettingsBtn,userSettingsBtn2,walletInfoBtn,walletInfoBtn2].forEach(b=>{ if(b) b.classList.remove('active'); });
}
function openPanel(panel, btn){
  const isOpen = panel.classList.contains('open');
  closeAllPanels();
  if(!isOpen){
    panel.classList.add('open');
    panel.setAttribute('aria-hidden','false');
    if(btn) btn.classList.add('active');
    updatePanelData();
  }
}
function updatePanelData(){
  // sync data into the panels
  document.getElementById('panelWalletAmount').textContent = localStorage.getItem('wallet_'+currentUser) || '0';
  document.getElementById('panelWalletStatus').textContent = localStorage.getItem('pro_'+currentUser)==='1' ? 'پرو فعال' : 'نسخهٔ رایگان';
  document.getElementById('panelLastLogin').textContent = localStorage.getItem('_'+currentUser) || '-';
  document.getElementById('panelStatus').textContent = localStorage.getItem('pro_'+currentUser)==='1' ? 'پرو فعال' : 'نسخهٔ رایگان';
  document.getElementById('panelWalletAmount').textContent = localStorage.getItem('wallet_'+currentUser) || '0';
  document.getElementById('panelLastLogin').textContent = localStorage.getItem('_'+currentUser) || '-';
  document.getElementById('panelStatus').textContent = localStorage.getItem('pro_'+currentUser)==='1' ? 'پرو فعال' : 'نسخهٔ رایگان';
}

// wire buttons (both top sets)
[userSettingsBtn,userSettingsBtn2].forEach(b=>{ if(b) b.addEventListener('click', ()=> openPanel(userPanel,b)); });
[walletInfoBtn,walletInfoBtn2].forEach(b=>{ if(b) b.addEventListener('click', ()=> openPanel(walletPanel,b)); });

// close buttons
document.getElementById('closeUserPanel').addEventListener('click', ()=> closeAllPanels());
document.getElementById('closeWalletPanel').addEventListener('click', ()=> closeAllPanels());

// clicking outside panels closes them
document.addEventListener('click', (e)=>{
  const panels = [userPanel,walletPanel];
  if(panels.some(p=>p.contains(e.target))) return;
  const btns = [userSettingsBtn,userSettingsBtn2,walletInfoBtn,walletInfoBtn2];
  if(btns.some(b=>b && b.contains(e.target))) return;
  closeAllPanels();
});
// prevent panel inner clicks from bubbling
[userPanel,walletPanel].forEach(p=> p.addEventListener('click', e=> e.stopPropagation()));

// ----- Wallet actions inside panels ----- //
document.getElementById('panelTopupBtn').addEventListener('click', ()=>{
  if(!currentUser){ alert('ابتدا وارد شوید'); return; }
  const key = 'wallet_'+currentUser;
  let w = parseInt(localStorage.getItem(key) || '0',10);
  w += 10;
  localStorage.setItem(key,String(w));
  updateUI();
  updatePanelData();
  alert('کیف پول شما 10$ شارژ شد');
});

document.getElementById('panelBuyBtn').addEventListener('click', ()=>{
  if(!currentUser){ alert('ابتدا وارد شوید'); return; }
  const key = 'wallet_'+currentUser;
  let w = parseInt(localStorage.getItem(key) || '0',10);
  if(w < 10){ alert('موجودی کافی نیست. کیف پول را شارژ کنید.'); return; }
  if(!confirm('خرید نسخهٔ پرو با قیمت 10$؟')) return;
  w -= 10;
  localStorage.setItem(key,String(w));
  localStorage.setItem('pro_'+currentUser,'1');
  updateUI();
  updatePanelData();
  appendBot('خرید موفق! حالا شما پرو هستید — پاسخ‌ها گسترده‌تر خواهند بود.');
});

// Save user edit inside user panel
document.getElementById('saveUserBtn').addEventListener('click', ()=>{
  const newU = document.getElementById('editUsername').value.trim();
  const newP = document.getElementById('editPassword').value;
  if(!newU){ alert('لطفاً نام کاربری جدید وارد کنید'); return; }
  // migrate/create if needed: keep wallet and pro separate per username
  if(localStorage.getItem('wallet_'+newU) === null) localStorage.setItem('wallet_'+newU,'10');
  if(localStorage.getItem('pro_'+newU) === null) localStorage.setItem('pro_'+newU,'0');
  localStorage.setItem('_'+newU, todayStr());
  currentUser = newU;
  updateUI();
  alert('تغییرات ذخیره شد. اکنون با نام کاربری جدید وارد شده‌اید.');
  closeAllPanels();
});

// ensure UI updates when localStorage changes in this page
window.addEventListener('storage', (e)=>{ if(e.key && currentUser && (e.key.startsWith('wallet_') || e.key.startsWith('pro_') || e.key === '_'+currentUser)) updateUI(); });

// initialize small default state for demo_user if present
if(localStorage.getItem('wallet_demo_user') === null) localStorage.setItem('wallet_demo_user','10');

// small UX: press Enter (with Ctrl) to send
document.getElementById('userInput').addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' && (e.ctrlKey || e.metaKey)) { e.preventDefault(); sendBtn.click(); }
});

// Initialize (if already logged in in same tab)
(function init(){
  // no auto-login to respect privacy, but update global UI if currentUser in sessionStorage
  const saved = sessionStorage.getItem('rx_current_user');
  if(saved){ currentUser = saved; showChatView(); }
})();
</script>


</body></html>